---
title: "L03. MAB(Multi-armed Bandits)"
order: 3
date: "2021-03-15"
---

# Evaluative Feedback vs. Instructive Feedback

RL과 지도학습(Supervised Learning)의 큰 차이 중 하나가, RL은 Evaluative Feedback을 이용해 학습되고 지도학습은 Instructive Feedback을 이용해 학습이 진행된다는 것이다. 

Evaluative Feedback은 (에이전트가 취한 행동에 대한 결과값으로서) 취한 행동이 얼마나 좋은지를 알려주는 값이다. 단 Evaluative Feedback은 어떤 행동이 최고의 행동인지 알려주진 않는다. Evaluative Feedback은 에이전트가 이때까지 취한 행동에 대해 종속적인 값이다. RL은 이 값을 이용해 학습을 진행한다.

한편 Instructive Feedback은 어떤 행동이 맞는 행동인지(= 최고의 행동인지)를 알려주는 값이다. 이 값은 에이전트가 이때까지 취한 행동과는 독립적인 값이다.[^1] 지도학습은 이 값을 이용해 학습을 진행한다.

[^1]: 원래 피드백이라는 단어는 어떤 행동을 했을 때 그에 대한 결과값을 뜻하는 용어이다. 그렇기에 Evaluative Feedback에서의 피드백이라는 단어는 적절한 단어다. 말 그대로 에이전트의 행동에 의해 에이전트를 둘러싸고 있는 환경이 그 결과로서 제공하는 값이기 때문이다. 그러나 Instructive Feedback의 경우 행동과 관련없는 독립적인 값으로, 피드백이라는 단어가 사실 적절치 않다. Instructive Feedback이라는 용어는 순전히 Evaluative Feedback에 대한 반댓말로서, Evaluative Feedback과 대구(對句)를 이루고자 Feedback이라는 단어를 쓴 것이다. 

# k-armed Bandit Problem

다음 문제를 생각해 보자.

> 철수는 미국 여행 중 라스베가스 공항을 경유하게 되었다. 다음 비행기는 2시간 후 출발할 예정이라, 철수는 그동안 라스베가스 공항의 명물, 슬롯머신을 당겨 보기로 했다. 다행히 공항에 사람이 별로 없어서 철수는 10대의 슬롯머신을 전세내고 사용할 수 있다. 각 슬롯머신에서 돈을 딸 확률은 기기마다 각자 다른 값으로 고정되어 있고, 한 번에 한 대의 슬롯머신만 당길 수 있다고 할 때, 철수는 어떤 전략을 취해야 가장 많은 돈을 딸 수 있을까?

만약 철수가 전체 슬롯머신의 확률 분포를 정확히 알고 있다면 당연히 그 중 가장 높은 확률을 가진 기기만 2시간 내내 당기는 것이 가장 많은 돈을 따는 방법일 것이다. 하지만 철수는 ~~당연히~~ 슬롯머신들의 확률 분포를 정확히 모르기에 실험을 통해 이를 추정해야 한다. 더 많은 슬롯 머신에 대해 더 많은 실험을 진행할수록 더 정확한 확률 분포를 알 수 있겠지만, 이 과정에 너무 많은 시간을 투자하면 막상 결과적으로 얻는 최종 액수는 적어질 것이다.

이와 같이 k개의 선택 가능한 옵션이 있고, 한 옵션을 선택하면 고정된 확률 분포(stationary probability distribution)에 따라 보상(numerical reward)을 받을 수 있을 때, 특정 시간(횟수) 동안 받을 수 있는 전체 보상을 최대화하는 문제를 k-armed Bandit Problem 또는 Multi-armed Bandit Problem(MAB)이라 한다.[^2]

[^2]: 많은 책이나 블로그에서 K-armed Bandit Problem을 잘못 해석해 "외팔이 강도(One-armed Bandit)가 k개의 슬롯머신을 당길 때 보상을 최대화하는 문제"라 설명을 하는데, 사실 one-armed bandit는 미국에서는 슬롯 머신을 부르는 속어이다(팔 하나(레버)를 달고 당신을 털어가기 때문). k-armed Bandit Problem은 여기에서 이름을 따온 것이다. 즉 k-armed Bandit Problem이라 하면 (정상적인 사람이) 레버가 k개 있는 슬롯 머신에서, k개의 레버 중 하나를 골라 당기는 과정을 여러 번 반복할 때 받을 전체 보상을 최대화하는 문제를 뜻한다.

MAB에서 현재 추정하고 있는 각 행동(action)의 가치(value) 중 가장 큰 값을 가지는 행동을 "탐욕적 행동(greedy action)"이라 한다.[^3] 만약 당신이 탐욕적 행동을 선택한다면 당신은 이전 지식을 활용(exploiting)한 것이다. 하지만 만약 비탐욕적 행동(nongreedy action)을 선택한다면 당신은 탐색(exploring)을 한 것으로, 이를 통해 해당 비탐욕적 행동의 가치를 조금 더 정확히 추정할 수 있게 되기 때문이다. 탐색(Exploration)을 수항하면 단기간 수령하는 보상은 작을 수 있으나, 장기적으로 봤을 때 전체적으로 받을 보상이 커진다. MAB에서는 한 번에 한 가지 선택만 할 수 있으므로[^4] 탐색(Exploration)과 활용(Exploitation)은 서로 상충되는 관계이다.

[^3]: 당연히 가치는 추정값이기에, 시간이 지나면서 탐욕적 행동 역시 바뀔 것이다.
[^4]: 사실 MAB뿐만 아니라 많은 경우 한 번에 한 가지 선택밖에 할 수 없다.

---
title: "vim"
date_created: "2022-02-10"
date_modified: "2022-02-12"
---

vim 꿀팁 모음

# command 모음

## insert mode로 진입하기 위한 키

- `i` : 현재 커서 위치에서 편집 시작. 가장 기본적인 키.
- `I` : 현재 커서가 위치한 행의 가장 앞에서 편집 시작
- `a` : 현재 커서 바로 다음 칸에서 편집 시작
- `A` : 현재 커서가 위치한 행의 가장 가장 뒤에서 편집 시작
- `o` : 현재 커서가 위치한 행 바로 밑에 새로운 행을 만들고, 그 새로운 행에서 편집 시작
- `O` : 현재 커서가 위치한 행 바로 위에 새로운 행을 만들고, 그 새로운 행에서 편집 시작
- `s` : 현재 커서 위치에서 바로 다음 한 글자를 지우고(delete), 그 위치에서 편집 시작
- `S` : 현재 커서가 위치한 행을 모두 지우고, 그 행에서 편집 시작
- `R` : (GUI 텍스트 편집기에서 `insert` 키를 눌렀을 때처럼) 현재 커서 위치에서 덮어쓰기(replace) 편집 시작. Esc 누르면 normal mode로 진입(덮어쓰기 편집 종료)

## 저장 및 종료

- `:w` : 저장
- `:q` : 종료. 저장되지 않은 편집 내역이 있으면 종료되지 않는다.
- `:wq`, `:x`, `ZZ` : 저장 후 종료
- `:q!` `ZQ` : 저장하지 않고 종료

## undo, redo

- `u` : undo
- `ctrl + r` : redo(undo undo, revert)
- `.` : 마지막 수행 작업 반복

## 단어 편집

- `diw` : 현재 커서가 위치하고 있는 단어 삭제(잘라내기)
- `yiw` : 현재 커서가 위치하고 있는 단어 복사
- `P` : 현재 커서 위치에 붙여넣기

## 행 편집

- `dd`, `:d` : 행 삭제(잘라내기)
- `yy`, `:y` : 행 복사하기
- `P` : 현재 커서 위치에 붙여넣기

## 이동

- `gg` : 문서의 처음으로 이동
- `G` : 문서의 끝으로 이동
- `H` : 현재 화면의 제일 윗 행으로 이동
- `L` : 현재 화면의 제일 마지막 행으로 이동
- `:n` : n번째 행으로 이동

## 검색

- `/[pattern]` : `[pattern]`(정규표현식)을, 현재 커서 위치에서부터 문서 하단 방향으로 검색
- `?[pattern]` : `[pattern]`(정규표현식)을, 현재 커서 위치에서부터 문서 상단 방향으로 검색
- `n` : 다음 검색 결과로 이동(`/` 검색을 하고 있을 경우 문서의 밑으로, `?` 검색을 하고 있을 경우 문서의 위로 이동)
- `N` : 이전 검색 결과로 이동(`/` 검색을 하고 있을 경우 문서의 위로, `?` 검색을 하고 있을 경우 문서의 밑으로 이동)
- `*` : 현재 커서가 위치한 단어를 검색해, 그 다음 매칭으로 이동
- `#` : 현재 커서가 위치한 단어를 검색해, 그 전 매칭으로 이동

## 찾아 바꾸기

- `:%s/[pattern]/[replacement]/g` : 문서 전체에서, `[pattern]`(정규표현식)을 찾아, `[replacement]`로 바꾸기
- `:%s/[pattern]/[replacement]/gc` : 문서 전체에서, `[pattern]`(정규표현식)을 찾아, `[replacement]`로 바꾸기. 다만 바꿀 때마다 확인을 받는다.

# 기타

## readonly 파일 편집 후 저장 실패한 경우 저장하기

가끔 터미널에서 작업하다 보면, `sudo` vim으로 열었어야 하는 파일을 아무 생각 없이 현재 사용자 권한의 vim으로 여는 경우가 있다. 이렇게 열면 vim은 읽기 전용(readonly) 파일이라고 아래에 명시하고, 이 파일을 편집하려고 insert mode에 진입하면 빨간색 글씨로 이 파일은 읽기 전용 파일임을 경고한다. 하지만 인간의 인지 능력은 놀랍게도 vim의 이런 노력을 쉽게 무시하고, 아무 생각 없이 읽기 전용 파일을 편집해 버리는 실수를 범하곤 한다. 그렇게 시스템 파일을 열심히 수정하고 저장하려고 보면 이런, vim이 계속 경고해 왔던 대로, 읽기 전용 파일이어서 `:w`가 먹히질 않는다. 이 경우 어떻게 해야 할까? 수정 내역을 전부 버리고 `:q!`로 나갔다가, 다시 `sudo` vim으로 열어 다시 수정해야 할까?

다행히, 이럴 때 쓸 수 있는 방법이 있다. vim에서 다음 명령어를 실행하는 것이다.

{:.code-header}
readonly 파일 편집 후 저장 실패한 경우 저장하기

{% highlight vim %}
:w !sudo tee %
{% endhighlight %}

위 명령어를 해석하면, 파일을 저장한 후, 그러니까 파일의 내용을 출력 스트림에 올린 후(`:w`), 터미널 명령어 `tee`를 `sudo`로 실행해(`!sudo tee`) 그 스트림을 받아서, 현재 파일(`%`)에 이를 쓰겠다는 것이다. 위 명령어를 실행하면 우선 `sudo`를 위한 password 입력을 요구한다. password를 입력하면 `tee`가 파일을 업데이트한 후, vim이 파일 변화를 감지해 파일을 다시 읽어들일지를 묻는데, 이때 `L`(Load file)을 입력하면 된다. 이제 편집 내용을 보존한 채로, `:q`를 이용해 정상적으로 vim을 종료하면 된다.
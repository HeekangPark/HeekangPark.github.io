---
title: "지킬 디렉토리 구조"
order: 4
date: "2020-12-11"
---

[이전 글](/jekyll/03-config-yml#kramdown_include-exclude)에서 설명했듯이, 지킬은 디렉토리 안에 있는 모든 파일 및 디렉토리를 빌드한다. 하지만 몇몇 디렉토리는 약간 다른 방식으로 빌드하거나, 아예 빌드하지 않는다. 이번 글에서는 지킬이 사용하는 특수한 디렉토리를 살펴보겠다.

# _site

`_site` 디렉토리는 빌드된 HTML 및 기타 파일(css, js, 이미지 등)들이 저장되는 디렉토리이다. 당연히 이 디렉토리 안의 파일들은 빌드되지 않는다.

만약 `_site` 말고 다른 디렉토리를 사용하고 싶다면 `_config.yml`에서 destination 설정에 값을 입력하면 된다(아무것도 입력하지 않으면 디폴트로 `./_site`가 사용된다).

`bundle exec jekyll serve` 명령어로 테스트 서버를 새로 열 때마다 `_site` 디렉토리 안의 모든 내용은 삭제되고 새로 빌드된 파일들이 저장된다. 만약 이 디렉토리 안에 반드시 남겨야 하는 디렉토리 혹은 파일이 있다면 `_config.yml`에서 keep_files 설정에 추가하면 된다.[^1]

[^1]: `_site` 디렉토리로부터 시작하는 상대 경로로 입력하면 된다. ex. `keep_files: ["home.html", "debug/"]`

[이전 글](/jekyll/03-config-yml#kramdown_plugins)에서 설명했듯이, 깃허브 페이지에서는 허용된 플러그인 이외의 사용이 금지되어 있다. 만약 반드시 플러그인을 사용해야 한다면 로컬에서 빌드한 후 빌드된 파일을 깃허브 저장소(Repository)에 push하면 되는데, 바로 `_site` 디렉토리를 그대로 push하면 된다.

만약 플러그인을 사용하지 않고 지킬 디렉토리 그 자체로 그대로 올린다면 `_site` 디렉토리는 굳이 없어도 된다. 어차피 깃허브 페이지가 자체적으로 빌드를 다시 하기 때문이다. 따라서 `.gitignore`에 `_site`를 추가하는 것이 좋다.

# _plugins

`_plugins` 디렉토리는 플러그인들이 저장되는 디렉토리이다. 본 블로그는 사용하지 않는다.

만약 `_plugins` 말고 다른 디렉토리를 사용하고 싶다면 `_config.yml`에서 plugins_dir 설정에 값을 입력하면 된다(아무것도 입력하지 않으면 디폴트로 `_plugins`가 사용된다).

# _layouts

`_layouts` 디렉토리는 레이아웃 파일들이 저장되는 디렉토리이다. 블로그의 모든 글들은 반드시 layout이 Front Matter에 명시되어야 하므로[^2], 아주 중요한 디렉토리라 할 수 있다. 본 블로그에서도 아주 절찬리에 사용 중이다.

[^2]: 실험 결과 layout을 명시하지 않아도 `default.html` 레이아웃이 존재한다면 자동으로 이를 사용하는 것으로 확인되는데, 정식 기능은 아닌 것으로 보이니 반드시 명시하도록 하자. 물론 `_config.yml` 파일에서 defaults 설정을 이용해 명시할 수도 있다.

레이아웃 파일은 되도록이면 html로 작성하는 것을 추천한다. 마크다운을 사용해도 되지만 번거로운 문제가 생길 수 있다([해당 문서](/jekyll/05-rendering-order) 참조).

레이아웃 파일을 작성하는 방법은 간단하다. 레이아웃 표시를 위한 HTML 요소들을 적당히 나열하고, 컨텐츠가 들어갈 자리에 `{% raw %}{{ content }}{% endraw %}`를 쓰면 된다. 예를 들어, 다음과 같이 레이아웃 파일 `_layouts/my-layout.html`, 컨텐츠 파일 `test.html`이 주어졌다고 해 보자.

{: .code-header}
_layouts/my-layout.html

{% highlight html %}
<!DOCTYPE html>
<html lang="ko">
<head>
<title>{% raw %}{{ page.title | append: " | " | append: site.title}}{% endraw %}</title>
</head>
<body>
    <p id="title">{% raw %}{{ page.title }}{% endraw %}</p>
    <div id="content">
        {% raw %}{{ content }}{% endraw %}
    </div>
    <style>
        #title {
            font-weight: bold;
            font-size: 1.1em;
            text-align: center;
            padding-top: 1em;
            padding-bottom: 1em;
            background-color: lightyellow;
        }
        #content {
            padding: 1em;
            background-color: lightgreen;
        }
    </style>
</body>
</html>
{% endhighlight %}

{: .code-header}
test.html

{% highlight html %}
---
title: test page
layout: my-layout
---

<p>This is a test.</p>
<p>Test list</p>
<ul>
    <li>List Item 1</li>
    <li>List Item 2</li>
    <li>List Item 3</li>
</ul>
{% endhighlight %}

빌드 시 컨텐츠 파일은 레이아웃 파일의 `{% raw %}{{ content }}{% endraw %}` 위치에 들어가, 최종적으로 다음과 같이 병합된다.

{: .code-header}
_layouts/my-layout.html + test.html

{% highlight html %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <title>test page | Reinventing the Wheel</title>
</head>
<body>
    <p id="title">test page</p>
    <div id="content">
        <p>This is a test.</p>
<p>Test list</p>
<ul>
    <li>List Item 1</li>
    <li>List Item 2</li>
    <li>List Item 3</li>
</ul>
    </div>
    <style>
        #title {
            font-weight: bold;
            font-size: 1.1em;
            text-align: center;
            padding-top: 1em;
            padding-bottom: 1em;
            background-color: lightsalmon;
        }
        #content {
            padding: 1em;
            background-color: lightgreen;
        }
    </style>
</body>
</html>
{% endhighlight %}

{% include caption-img.html src="jekyll-directory-layout-result.png" title="빌드 결과" description="_layouts/my-layout.html + test.html" %}

참고로 Front Matter에 layout을 명시할 때는 뒤의 확장자는 굳이 적지 않아도 된다. 예를 들어 본 페이지의 레이아웃은 `_layouts/document.html` 파일에 정의되어 있는데, 이를 사용하기 위해서 다음과 같이 하면 된다.

{% highlight markdown %}
---
layout: document
---
{% endhighlight %}

레이아웃 파일에 Front Matter을 넣고 layout을 명시해 주면 한 레이아웃 위에 다른 레이아웃을 올릴 수도 있다. 예를 들어 본 블로그의 경우 `_layouts/document.html` 레이아웃은 `_layouts/default.html` 레이아웃을 바탕으로 만들어졌다. 이를 위해 `_layouts/document.html` 파일은 다음과 같은 Front Matter를 사용하고 있다.

{: .code-header}
_layouts/document.html

{% highlight markdown %}
---
layout: default
---
⋮
{% endhighlight %}

# _data

`_data` 디렉토리는 데이터 파일을 보관하는 디렉토리이다. 지킬에서는 YAML, JSON, CSV, TSV 포멧으로 된 데이터 파일을 사용할 수 있다.[^3]

[^3]: CSV, TSV 파일은 반드시 헤더 행(Header Row)이 있어야 한다.

데이터 파일에 저장된 값에는 Liquid 문법을 이용해 접근할 수 있다. JSON, YAML 파일의 경우 다음 방식으로 접근 가능하다.

{% highlight liquid %}
{% raw %}{{ site.data.<data_file_basename>.<key> }}{% endraw %}
{% endhighlight %}

- `<data_file_basename>` : 데이터 파일의 basename[^4]
- `<key>` : 접근하고자 하는 키

[^4]: Basename이란 확장자를 제외한 파일명을 뜻한다. 예를 들어 `info.yml`의 basename은 `info`이다. 접근법을 보면 알겠지만, 데이터 파일들은 파일의 basename을 접근 키로 사용한다. 따라서 `_data` 디렉토리 안의 모든 파일들은 basename이 다 달라야 한다. basename은 같고 확장자만 다른 파일이 있으면 오류가 발생한다.

예를 들어, 본 블로그에서는 `_data/info.yml`이라는 YAML 데이터 파일을 사용하고 있다.

{: .code-header}
_data/info.yml

{% highlight yaml %}
name: Heekang Park
email: park.heekang33@gmail.com
⋮
{% endhighlight %}

이때, `name` 키의 값은 다음 방식으로 얻을 수 있다.

{% highlight liquid %}
{% raw %}{{ site.data.info.name }}{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
Heekang Park
{% endhighlight %}

CSV, TSV 파일 혹은 JSON, YAML 배열의 경우 다음과 같이 반복문과 함께 쓸 수 있다.

{: .code-header}
_data/grade.csv

{% highlight csv %}
name,score
Alice,100
Bob,80
Charlie,65
David,95
Eve,100
⋮
{% endhighlight %}

{: .code-header}
test.html

{% highlight html %}
⋮
<ul>
{%- raw -%}
{% for line in site.data.grade %}
    <li>{{ line.name }} : {{ line.score }}</li>
{% endfor %}
{% endraw %}
</ul>
⋮
{% endhighlight %}

{: .code-result}
{% highlight text %}
⋮
• Alice : 100
• Bob : 80
• Charlie : 65
• David : 95
• Eve : 100
⋮
{% endhighlight %}

`_data` 디렉토리 안에 서브디렉토리를 만들고 그 안에 데이터 파일을 넣는 경우, 해당 서브디렉토리를 키로 하여 데이터 파일들에 접근할 수 있다. 예를 들어, 다음과 같이 `_data` 디렉토리 밑에 `students` 서브디렉토리가 있고, 그 안에 `undergraduate.csv`, `graduate.csv` 파일이 존재한다고 해 보자.

{% highlight text %}
./_data
├── info.yml
├── grade.csv
└── students
    ├── undergraduate.csv
    └── graduate.csv
{% endhighlight %}

이 경우 `undergraduate.csv`에는 다음과 같이 접근할 수 있다.

{% highlight liquid %}
{% raw %}{{ site.data.students.undergraduate }}{% endraw %}
{% endhighlight %}


collection, post

---
title: "Liquid"
order: 6
date: "2020-12-13"
---

지킬을 자유자재로 사용하기 위해서는 반드시 Liquid 템플릿 언어를 사용할 줄 알아야 한다.

Liquid 문법에 대해 알아보자.

# 데이터 타입

지킬이 사용하는 데이터 타입은 5종류가 있다.

- String: 작은따옴표 혹은 큰따옴표로 둘러싸인 문자열. ex. "Hello World!", "a", "3", "false", ...
- Number: 정수 혹은 실수. ex. 3, -2.5, ...
- Boolean: 참 또는 거짓. Boolean 값을 입력할 때 따옴표는 쓰면 안된다(따옴표를 쓰면 String이 된다). ex. true, false
- Nil: 빈 값(Empty value).[^1] 정의되지 않은 변수는 Nil 값을 가지고 있다. Nil을 출력하면 아무것도 나오지 않는다. Nil은 조건문에서 거짓(false)으로 평가된다.
- Array: 배열. 파이썬의 리스트와 유사하게 크기 제약이 없고, 어떠한 타입의 값이든 저장할 수 있다.[^2] 배열의 각 원소는 대괄호(`[`, `]`)에 인덱스 값을 넣어 읽을 수 있다(쓸 수는 없다). 아래에서 나오는 `{% raw %}{% for %}{% endraw %}` 구문 등과 함께 자주 쓰인다.

[^1]: C언어의 `NULL`, 파이썬의 `None`, JS의 `null` 혹은 `undefined`와 같은 개념이다.
[^2]: 하지만 Liquid에서는 빈 배열을 만드는 문법이 없어, 배열을 하나 만드려면 문자열을 잘라서 만드는 간접적인 방법을 써야 한다. 그래서 일반적으로 배열은 문자열 타입만을 담는다. Liquid가 HTML, 마크다운 문서 등을 포멧팅하는 목적으로 쓰인다는 점을 생각한다면, 문자열만 담을 수 있어도 사용하는데 아무 문제 없다.

# 오브젝트(Object), 태그(Tag), 필터(Filter)

Liquid 코드는 크게 오브젝트(Object), 태그(Tag), 필터(Filter)로 구분할 수 있다.

## 오브젝트 (Object)

오브젝트는 이중 중괄호({% raw %}`{{`, `}}`{% endraw %})로 둘러싸인 코드를 뜻한다. 이 코드는 이중 중괄호 안에 있는 값을 출력한다. C언어의 `printf()` 함수, 파이썬의 `print()` 함수와 유사하다.

{% highlight liquid %}
{% raw %}
{{ "Hello World!" }}
{{ 268.54 }}
{{ false }}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
Hello World!
268.54
false
{% endhighlight %}

물론, 이렇게 상수를 출력하는 목적으로는 거의 사용하지 않는다. 오브젝트는 일반적으로 변수를 출력하는 목적으로 많이 사용한다.

{% highlight liquid %}
{% raw %}
{% assign text = "Hello World!" %}
{{ text }}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
Hello World!
{% endhighlight %}

1행의 코드는 `text`라는 변수를 선언하고 그 안에 "Hello World"라는 값을 대입하는 코드이다(자세한 것은 아래 [변수 선언문](#kramdown_변수-선언문) 문단을 참조하자). 이처럼 변수명을 이중 중괄호 사이에 입력하면, 변수가 담고 있는 값이 출력된다.

## 태그 (Tag)

태크는 {% raw %}`{%`, `%}`{% endraw %}으로 둘러싸인 코드를 뜻한다. 몇몇 예외를 제외하고, 대부분의 Liquid 태그는 시작 태그와 종료 태그의 쌍으로 이루어진다. 종료 태그는 시작 태그에 `end`를 붙인 것이다. 예를 들어 조건문 태그의 경우 시작 태그로 `{% raw %}{% if %}{% endraw %}`를 사용하고 종료 태그로 `{% raw %}{% endif %}{% endraw %}`를 사용한다. 시작 태그와 종료 태그는 C언어에서의 중괄호 쌍(`{`, `}`), 파이썬에서의 들여쓰기 문단과 같이, 조건문, 반복문 등이 동작하는 범위를 나타낸다.

태그는 다시 변수 선언문, 조건문, 반복문, 주석문, raw문으로 구분할 수 있다.

### 변수 선언문

지킬에서 변수를 선언하는 방법은 `{% raw %}{% assign %}{% endraw %}` 구문을 이용하는 방법과 `{% raw %}{% capture %}{% endraw %}` 구문을 이용하는 방법, 이렇게 두 가지가 있다.

#### {% raw %}{% assign %}{% endraw %}
`{% raw %}{% assign %}{% endraw %}`을 이용하면 String, Number, Boolean 형 변수를 선언할 수 있다. 사용 방법은 `=` 기호의 왼편에 변수명, 오른편에 변수에 대입할 값을 넣어주면 된다. 아래 예시 코드를 참조하자.

{% highlight liquid %}
{% raw %}
{% assign var1 = "Hello World!" %}
{{ var1 }}

{% assign var2 = -2.835 %}
{{ var2 }}

{% assign var3 = true %}
{{ var3 }}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
Hello World!
-2.835
true
{% endhighlight %}

#### {% raw %}{% capture %}{% endraw %}

`{% raw %}{% capture %}{% endraw %}`를 이용하면 String 형 변수를 선언할 수 있다. 사용 방법은 `{% raw %}{% capture %}{% endraw %}` 중괄호 안에 변수명을 입력한 후, `{% raw %}{% capture %}{% endraw %}`와 `{% raw %}{% endcapture %}{% endraw %}` 사이에 변수에 대입할 값을 넣어주면 된다. 다음 예시 코드를 참조하자.

{% highlight liquid %}
{% raw %}
{% capture var %}Hello World!{% endcapture %}
{{ var }}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
Hello World!
{% endhighlight %}

`{% raw %}{% capture %}{% endraw %}`의 강력한 점 중 하나는 다른 변수가 들어간 String으로 변수를 초기화할 수 있다는 것이다. 예를 들어, 아래 예시 코드에서 `var` 변수에는 `Hello! My name is Heekang Park and I'm 26 years old.` 값이 대입되어 있다.

{% highlight liquid %}
{% raw %}
{% assign age = 26 %}
{% assign name = "Heekang Park" %}
{% capture var %}Hello! My name is {{ name }} and I'm {{ age }} years old.{% endcapture %}
{{ var }}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
Hello! My name is Heekang Park and I'm 26 years old.
{% endhighlight %}

#### Nil 타입 변수 초기화

파이썬 등에서는 `x = None`과 같이 하여 빈 값을 명시적으로 선언할 수 있는데, Liquid에서는 Nil 값을 가지는 변수를 명시적으로 선언할 수 없다. 사실 Nil 값을 명시적으로 선언해야 할 일은 거의 일어나지 않기에, 큰 문제가 되진 않는다.

하지만 만약에, 정말 꼭 Nil 값을 사용해야 한다면 선언하지 않은 변수를 사용하는 방법이 있다. 상술했다시피 `{% raw %}{% assign %}{% endraw %}` 혹은 `{% raw %}{% capture %}{% endraw %}`로 선언하지 않은 변수는 Nil 값을 가지고 있기 때문이다.

{% highlight liquid %}
{% raw %}
{{ var }}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
(아무 것도 출력되지 않음)
{% endhighlight %}

위 코드처럼 선언되지 변수를 출력하려 하면 아무 값도 출력되지 않는다. 상술했다시피 선언하지 않은 변수는 Nil 값을 가지고 있고, Nil은 출력 시 아무 값도 출력되지 않기 때문이다.

#### Array 타입 변수 초기화

Liquid에서는 Array형 변수를 명시적으로 선언할 수 없다. Array형 변수를 선언하려면 우선 String형 변수를 선언한 뒤, split 필터를 이용하는 간접적인 방법을 사용해야 한다. split 필터에 관한 자세한 설명은 [아래 문단](#kramdown_split)을 참조하자.

{% highlight liquid %}
{% raw %}
{% assign arr = "Apple,Banana,Tomato" | split: "," %}
{{ arr[0] }}
{{ arr[1] }}
{{ arr[2] }}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
Apple
Banana
Tomato
{% endhighlight %}

### 조건문

Liquid에서는 `{% raw %}{% if %}{% endraw %}`, `{% raw %}{% unless %}{% endraw %}`, `{% raw %}{% case %}{% endraw %}`, 이렇게 3가지 형태의 조건문을 사용할 수 있다.

#### 조건식에서 사용 가능한 연산자

우선 조건문들이 사용하는 조건식에서 사용 가능한 연산자들의 종류를 알아보자. Liquid 조건식에서는 다음과 같은 연산자들을 사용할 수 있다.

- `==` : 같다
- `!=` : 같지 않다
- `>` : (좌항이 우항보다) 크다
- `<` : (좌항이 우항보다) 작다
- `>=` : (좌항이 우항보다) 크거나 같다
- `<=` : (좌항이 우항보다) 작거나 같다
- `contains` : 좌항의 String Array에 우항의 String이 원소로 있는지. 있으면 true, 없으면 false.

또한 조건식에서는 `or`과 `and`를 사용하여 논리합과 논리곱을 각각 표현할 수 있다. Liquid에서는 조건식에 괄호를 쓸 수 없다.[^3] 만약 여러 개의 `and`, `or` 연산자를 사용할 경우, 오른쪽에서 왼쪽 순서로 평가된다. 예를 들어, `true or false and false`는 `true`가 되고[^4], `true and false and false or true`는 `false`가 된다[^5].

[^3]: 괄호를 사용하면 문법 오류가 난다.
[^4]: `true or false and false == true or (false and false) == true or false == true`
[^5]: `true and false and false or true == true and (false and (false or true)) == true and (false and true) == true and false == false`

참고로 Liquid에서는 Nil과 false를 제외한 모든 값들이 `true`로 평가된다.[^6]

[^6]: 빈 String(`""`), 0(Number), 빈 Array도 `true`이다.

#### {% raw %}{% if %}{% endraw %}

`{% raw %}{% if %}{% endraw %}`는 다른 프로그래밍 언어와 유사하게 평가할 조건식을 입력하고, 그 조건이 참이면 아래 코드가 실행되는 구문이다.

{% highlight liquid %}
{% raw %}
{% assign score = 100 %}
{% if score > 90 %}
Grade: Pass
{% endif %}

{% assign fruits = "Apple,Banana,Tomato" | split: "," %}
{% if fruits contains "Banana" %}
Banana is in fruits.
{% endif %}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
Grade: Pass
Banana is in fruits.
{% endhighlight %}

`{% raw %}{% elsif %}{% endraw %}`를 사용하면 `{% raw %}{% if %}{% endraw %}`에 추가적인 조건식을 부여할 수 있다. `{% raw %}{% else %}{% endraw %}` 밑의 코드는 `{% raw %}{% if %}{% endraw %}`의 조건식이 거짓일 때 실행된다.

{% highlight liquid %}
{% raw %}
{% assign score = 100 %}
{% if score > 90 %}
    Grade: A
{% elsif score > 70 %}
    Grade: B
{% else %}
    Grade: Fail
{% endif %}

{% assign score = 50 %}
{% if score > 90 %}
    Grade: A
{% elsif score > 70 %}
    Grade: B
{% else %}
    Grade: Fail
{% endif %}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
Grade: A
Grade: Fail
{% endhighlight %}

#### {% raw %}{% unless %}{% endraw %}

`{% raw %}{% unless %}{% endraw %}`는 주어진 조건식이 거짓일 때 아래 코드가 실행되는 구문이다. `{% raw %}{% unless %}{% endraw %}`와 정확히 반대로 동작한다.

{% highlight liquid %}
{% raw %}
{% assign height = 190 %}
{% unless height < 180 %}
    Watch your head!
{% endunless %}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
Watch your head!
{% endhighlight %}

#### {% raw %}{% case %}{% endraw %}

`{% raw %}{% case %}{% endraw %}`는 C언어의 switch 구문과 비슷하게 동작한다. 각 분기는 `{% raw %}{% when %}{% endraw %}`으로[^7], 디폴트 분기는 `{% raw %}{% else %}{% endraw %}`를 쓰면 된다[^8].

[^7]: C언어에서는 `case` 키워드를 사용한다.
[^8]: C언어에서는 `default` 키워드를 사용한다.

{% highlight liquid %}
{% raw %}
{% assign name = "Heekang" %}
{% case name %}
    {% when "Heekang" %}
        Hello, Owner!
    {% when "John" %}
        Hello, Friend!
    {% else %}
        Hello, Stranger!
{% endcase %}

{% assign name = "Sarah" %}
{% case name %}
    {% when "Heekang" %}
        Hello, Owner!
    {% when "John" %}
        Hello, Friend!
    {% else %}
        Hello, Stranger!
{% endcase %}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
Hello, Owner!
Hello, Stranger!
{% endhighlight %}

### 반복문

Liquid에서는 `{% raw %}{% for %}{% endraw %}`를 이용해 반복문을 구성할 수 있다.

#### {% raw %}{% for %}{% endraw %}

`{% raw %}{% for %}{% endraw %}`을 이용하면 배열의 원소를 순회할 수 있다.[^9] 예를 들어, 아래 코드는 ["Apple", "Banana", "Tomato"]가 저장되어 있는 Array형 변수 `fruits`의 모든 원소를 출력하는 코드이다.

[^9]: 파이썬의 for 구문과 비슷하다.

{% highlight liquid %}
{% raw %}
{% assign fruits = "Apple,Banana,Tomato" | split: "," %}
{% for fruit in fruits %}
    {{ fruit }}
{% endfor %}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
Apple
Banana
Tomato
{% endhighlight %}

위 예시 코드에서 볼 수 있듯이 `{% raw %}{% for %}{% endraw %}` 구문은 변수를 두 개 사용한다. 키워드 `in`을 기준으로, 오른편의 변수(`fruits`)는 순회하고자 하는 배열을 나타낸다. 왼편의 변수는 `{% raw %}{% for %}{% endraw %}`과 `{% raw %}{% endfor %}{% endraw %}` 사이에서만 유효한 지역 변수(local variable)로, 오른편의 Array형 변수의 원소가 앞에서부터 순서대로 하나씩 대입된다.

`{% raw %}{% else %}{% endraw %}`를 이용하면 `{% raw %}{% for %}{% endraw %}`으로 순회하고자 하는 배열에 원소가 하나도 없을 경우 동작하는 폴백(fallback)을 만들 수 있다.

{% highlight liquid %}
{% raw %}
{% assign array = "" | split: "," %}
{% for item in array %}
    {{ item }}
{% else %}
    The array is empty!
{% endfor %}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
The array is empty!
{% endhighlight %}

`{% raw %}{% break %}{% endraw %}`, `{% raw %}{% continue %}{% endraw %}`를 이용하면 코드 제어 흐름(control flow)을 조정할 수 있다. 반복문 안에서 `{% raw %}{% break %}{% endraw %}`을 만나면 반복을 중지하고 반복문을 탈출한다. 반복문 안에서 `{% raw %}{% continue %}{% endraw %}`를 만나면 남은 반복 구문의 실행을 생략하고, 다음 원소로 한 걸음 나간 다음 다시 반복 구문을 실행한다.

{% highlight liquid %}
{% raw %}
{% assign fruits = "Apple,Banana,Tomato" | split: "," %}
{% for fruit in fruits %}
    {% if fruit == "Banana" %}
        {% break %}
    {% endif %}

    {{ fruit }}
{% endfor %}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
Apple
{% endhighlight %}

{% highlight liquid %}
{% raw %}
{% assign fruits = "Apple,Banana,Tomato" | split: "," %}
{% for fruit in fruits %}
    {% if fruit == "Banana" %}
        {% continue %}
    {% endif %}

    {{ fruit }}
{% endfor %}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
Apple
Tomato
{% endhighlight %}

`{% raw %}{% for %}{% endraw %}`와 `{% raw %}{% endfor %}{% endraw %}` 사이에서는 `forloop`라는 이름의 변수에 접근할 수 있다. `forloop` 변수는 다음과 같은 속성(attribute)을 가지고 있다.

- `forloop.first` : 반복문이 첫 번째 반복을 실행 중이면 true, 아니면 false를 반환한다.
- `forloop.index` : 반복문의 반복 횟수를 반환한다.. 첫 번째 반복이면 1, 두 번째 반복이면 2, ...를 반환한다.
- `forloop.index0` : 반복문의 인덱스를 반환한다. 위 `forloop.index`와의 차이점은, `forloop.index`는 1부터 시작하지만 `forloop.index0`는 0부터 시작한다. `forloop.index0` = `forloop.index` - 1이 항상 성립한다.
- `forloop.last` : 반복문이 마지막 반복을 실행 중이면 true, 아니면 false를 반환한다.
- `forloop.length` : 반복문의 전체 반복 횟수를 반환한다.
- `forloop.rindex` : 역순으로의 `forloop.index`를 반환한다. `forloop.index` + `forloop.rindex` = `forloop.length` + 1이 항상 성립한다.
- `forloop.rindex0` : 역순으로의 `forloop.index0`를 반환한다. `forloop.index0` + `forloop.rindex0` = `forloop.length` - 1, `forloop.rindex0` = `forloop.rindex` - 1이 항상 성립한다.

{% highlight liquid %}
{% raw %}
{% assign numbers = "1,2,3,4,5" | split: "," %}
{% for number in numbers %}
    number = {{ number }}
    forloop.first = {{ forloop.first }}
    forloop.index = {{ forloop.index }}
    forloop.index0 = {{ forloop.index0 }}
    forloop.last = {{ forloop.last }}
    forloop.length = {{ forloop.length }}
    forloop.rindex = {{ forloop.rindex }}
    forloop.rindex0 = {{ forloop.rindex0 }}
    ===============================
{% endfor %}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
number = 1
forloop.first = true
forloop.index = 1
forloop.index0 = 0
forloop.last = false
forloop.length = 5
forloop.rindex = 5
forloop.rindex0 = 4
===============================

number = 2
forloop.first = false
forloop.index = 2
forloop.index0 = 1
forloop.last = false
forloop.length = 5
forloop.rindex = 4
forloop.rindex0 = 3
===============================

number = 3
forloop.first = false
forloop.index = 3
forloop.index0 = 2
forloop.last = false
forloop.length = 5
forloop.rindex = 3
forloop.rindex0 = 2
===============================

number = 4
forloop.first = false
forloop.index = 4
forloop.index0 = 3
forloop.last = false
forloop.length = 5
forloop.rindex = 2
forloop.rindex0 = 1
===============================

number = 5
forloop.first = false
forloop.index = 5
forloop.index0 = 4
forloop.last = true
forloop.length = 5
forloop.rindex = 1
forloop.rindex0 = 0
===============================
{% endhighlight %}

`limit`를 사용하면 반복할 횟수를 제한할 수 있다. 반복문은 `limit`로 제한한 횟수만큼만 딱 실행되고 반복을 종료한다.

{% highlight liquid %}
{% raw %}
{% assign numbers = "1,2,3,4,5" | split: "," %}
{% for number in numbers limit: 3 %}
    {{ number }}
{% endfor %}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
1
2
3
{% endhighlight %}

`offset`를 사용하면 반복을 시작할 인덱스 위치를 정할 수 있다. `offset` 값 이하 인덱스의 값들은 스킵된다. 인덱스는 0부터 시작함을 주의하자. 즉, `offset`으로 2를 주면, 인덱스 2(3번째 원소)부터 반복이 시작된다.

{% highlight liquid %}
{% raw %}
{% assign numbers = "1,2,3,4,5" | split: "," %}
{% for number in numbers offset: 2 %}
    {{ number }}
{% endfor %}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
3
4
5
{% endhighlight %}

`reversed`를 사용하면 반복의 방향을 역순으로 할 수 있다.

{% highlight liquid %}
{% raw %}
{% assign numbers = "1,2,3,4,5" | split: "," %}
{% for number in numbers reversed %}
    {{ number }}
{% endfor %}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
5
4
3
2
1
{% endhighlight %}

`limit`, `offset`, `reversed`는 혼용 가능하다. 이때, `reversed`는 반드시 Array 변수 바로 옆에 와야 하고[^10], `limit`과 `offset`의 순서는 어떠한 순서든 모두 허용된다. 또한 `reversed`는 `limit`, `offset` 등이 적용된 이후 가장 마지막에 적용된다.

[^10]: 예를 들어, `{% raw %}{% for number in numbers reversed offset: 2 limit: 3 %}{% endraw %}`는 되지만, `{% raw %}{% for number in numbers offset: 2 limit: 3 reversed %}{% endraw %}`는 문법 오류가 발생한다.

{% highlight liquid %}
{% raw %}
{% assign numbers = "1,2,3,4,5" | split: "," %}
{% for number in numbers reversed offset: 2 %}
    {{ number }}
{% endfor %}

{% assign numbers = "1,2,3,4,5" | split: "," %}
{% for number in numbers reversed offset: 2 limit: 2 %}
    {{ number }}
{% endfor %}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
5
4
3

4
3
{% endhighlight %}

`{% raw %}{% for %}{% endraw %}`에서는 두 숫자 범위(range)를 반복할 수도 있다. 시작값 `start`와 종료값 `end`를 `(start..end)` 꼴로 `in` 오른편에 적어 주면 된다. 파이썬의 `range()`와 유사한데, 중요한 차이점은 반복의 범위가 `start` 이상 `end` **이하**라는 것이다.[^11] `start`와 `end`는 음수일 수도 있지만, 반드시 `end`가 `start`보다 커야 한다. `start`와 `end`에는 변수를 쓸 수도 있다. 다음 예시 코드를 참조하자.

[^11]: 파이썬에서는 `start` 이상, `end` **미만**의 범위에서 반복한다.

{% highlight liquid %}
{% raw %}
{% assign fruits = "Apple,Banana,Tomato,Melon,Kiwi" | split: "," %}
{% assign start = 2 %}
{% for number in (start..5) %}
    number = {{ number }}
    fruits[number] = {{ fruits[number] }}
{% endfor %}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
number = 2
fruits[number] = Tomato

number = 3
fruits[number] = Melon

number = 4
fruits[number] = Kiwi

number = 5
fruits[number] = 
{% endhighlight %}

위 예제에서는 마지막 반복에서 `fruits`에서 존재하지 않는 인덱스 5번 원소에 접근하였기에 Nil(아무 값도 출력되지 않음)이 출력되었다.

당연히 `(start..in)`에 대해서도 `reversed`, `offset`, `limit`를 쓸 수 있다.

{% highlight liquid %}
{% raw %}
{% for number in (1..5) reversed offset: 2 limit: 3 %}
    {{ number }}
{% endfor %}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
5
4
3
{% endhighlight %}

### 기타 구문

#### 주석문

Liquid에서 주석은 다음과 같이 `{% raw %}{% comment %}{% endraw %}` 구문을 이용한다.

{% highlight liquid %}
{% raw %}
{% comment %}
Everything between comment tags are not interpreted.
{% endcomment %}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
(아무것도 출력되지 않음)
{% endhighlight %}

Liquid가 해석될 때 모든 주석은 삭제된다. 주석 안에 마크다운 문장, HTML 구문 등 어떠한 값을 입력해도 모두 출력되지 않는다([지킬 렌더링 순서](/jekyll/05-rendering-order) 문서 참조).

#### Raw문

Liquid는 Liquid의 문법을 구성하는 {% raw %}`{{`, `}}`, `{%`, `%}`{% endraw %} 기호들을 보면 이를 최대한 해석해보려 한 후, 문법 오류가 있다면 해당 문장의 해석을 건너뛰고(즉, 렌더링하지 않고) 넘어간다. 따라서, 이런 기호를 사용하고 싶으면 Liquid 엔진이 건드리지 않도록 이스케이프 처리가 필요하다. 이럴 때 쓰는 것이 `{% raw %}{% raw %}{% endraw %}` 구문이다. 참고로, Liquid 문법을 설명하는 이 문서에도 (당연히) 아주 많은 `{% raw %}{% raw %}{% endraw %}`가 사용되었다.

{% highlight liquid %}
{% raw %}{% raw %}{% endraw %}
{%- raw -%}
    {% assign fruits = "Apple,Banana,Tomato" | split: "," %}
    {% for fruit in fruits %}
        {{ fruit }}
    {% endfor %}
{% endraw %}
{%- assign temp = "{%" -%}
{{ temp }} endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
{% raw %}
{% assign fruits = "Apple,Banana,Tomato" | split: "," %}
{% for fruit in fruits %}
    {{ fruit }}
{% endfor %}
{% endraw %}
{% endhighlight %}

## 필터 (Filter)

필터란 오브젝트 또는 태그에 추가적으로 사용되어져, 출력 결과를 바꾸는 문법 요소이다. Liquid는 다양한 종류의 필터를 지원한다. 필터를 잘 쓰면 Liquid를 잘 다룰 수 있게 된다.

### abs : 절대값

abs 필터는 절대값을 반환하는 필터이다.

{% highlight liquid %}
{% raw %}
{{ -10 | abs }}

{% assign x = -35.123 | abs %}
{{ x }}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
10
35.123
{% endhighlight %}

만약 Number 타입이 아닌 값에 abs 필터를 씌우면 0이 출력된다.

{% highlight liquid %}
{% raw %}
{{ "String" | abs }}

{{ true | abs }}

{% assign array = "1,2,3" | split: "," %}
{{ array | abs }}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
0
0
0
{% endhighlight %}

### append : String 뒤에 붙이기

append 필터는 기존 값 뒤에 주어진 String을 붙여 합쳐진 String을 반환하는 필터이다.

{% highlight liquid %}
{% raw %}
{{ "Hello" | append: "World!" }}

{% assign path = "/jekyll" | append: "/06-liquid" %}
{{ path }}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
HelloWorld!
/jekyll/06-liquid
{% endhighlight %}

기존 값은 어떠한 데이터 타입이든 상관 없으나(모두 String으로 자동 변환되어 사용된다), append 할 String은 반드시 String이어야 한다(즉, 반드시 따옴표(`"`)로 묶여 있어야 한다).

### at_least : 출력되는 변수의 하한 정하기

at_least 필터는 변수를 출력할 때 그 하한을 지정할 수 있는 필터이다.

{% highlight liquid %}
{% raw %}
{{ 5 | at_least: 3 }}
{{ 1 | at_least: 3 }}

{% assign x = -10 | at_least: -2.375 %}
{{ x }}

{% assign y = 1 | at_least: -2.375 %}
{{ y }}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
5
3
-2.375
1
{% endhighlight %}

참고로 Number 타입이 아닌 값들은 모두 0으로 평가된다.

### at_most : 출력되는 변수의 상한 정하기

at_most 필터는 변수를 출력할 때 그 상한을 지정할 수 있는 필터이다.

{% highlight liquid %}
{% raw %}
{{ 5 | at_most: 3 }}
{{ 1 | at_most: 3 }}

{% assign x = -10 | at_most: -2.375 %}
{{ x }}

{% assign y = 1 | at_most: -2.375 %}
{{ y }}
{% endraw %}
{% endhighlight %}

{: .code-result}
{% highlight text %}
3
1
-10
-2.375
{% endhighlight %}

참고로 Number 타입이 아닌 값들은 모두 0으로 평가된다.

## 공백 처리

# 지킬과의 상호작용

## 지킬 변수

## 예제: 목차 (TOC)

Liquid는 분명 한계가 많은 템플릿 언어이지만, 잘 쓰면 아주 재미있는 기능들을 만들 수 있다.

예를 들어, 본 블로그에서 사용하고 있는 목차 기능은 순수 Liquid만을 이용해 만들어졌다. allejo의 [jekyll-toc](https://github.com/allejo/jekyll-toc)의 코드를 참조하여 직접 만들었다.

{% highlight html linenos %}
{% raw %}
{% assign h1counter = 0 %}
{% assign h2counter = 0 %}
{% assign h3counter = 0 %}
{% assign h4counter = 0 %}
{% assign h5counter = 0 %}
{% assign h6counter = 0 %}

{% assign nodes = include.html | split: "<h" %}

<div class="toc{% if nodes.size == 1 %} hidden {% endif %}">
    <p class="toc-title">목차</p>

    <div class="toc-content">
    {% for node in nodes %}
        {% if node == "" %}
            {% continue %}
        {% endif %}
        
        {% assign headerLevel = node | replace: '"', '' | slice: 0, 1 | times: 1 %}

        {% comment %}
        {% if headerLevel == 0 %}
            {% continue %}
        {% endif %}
        {% endcomment %}

        {% assign _temp = node | split: "</h" %}
        {% assign _temp = _temp[0] | split: ">" %}
        {% assign headerContent = _temp[1] | strip %}

        {% assign _temp = node | split: "</h" %}
        {% assign _temp = _temp[0] | split: 'id="' %}
        {% assign _temp = _temp[1] | split: '"' %}
        {% assign headerID = _temp[0] | strip %}

        {% case headerLevel %}
            {% when 0 %}
                {% continue %}
            {% when 1 %}
                {% assign h1counter = h1counter | plus: 1 %}
                {% assign h2counter = 0 %}
                {% assign h3counter = 0 %}
                {% assign h4counter = 0 %}
                {% assign h5counter = 0 %}
                {% assign h6counter = 0 %}
                <p class="toc-item toc-{{ headerLevel }}" id="toc-{{ headerID }}"><a href="#{{ headerID }}">{{ h1counter }}.</a> {{ headerContent }}</p>
            {% when 2 %}
                {% assign h2counter = h2counter | plus: 1 %}
                {% assign h3counter = 0 %}
                {% assign h4counter = 0 %}
                {% assign h5counter = 0 %}
                {% assign h6counter = 0 %}
                <p class="toc-item toc-{{ headerLevel }}" id="toc-{{ headerID }}"><a href="#{{ headerID }}">{{ h1counter }}.{{ h2counter }}.</a> {{ headerContent }}</p>
            {% when 3 %}
                {% assign h3counter = h3counter | plus: 1 %}
                {% assign h4counter = 0 %}
                {% assign h5counter = 0 %}
                {% assign h6counter = 0 %}
                <p class="toc-item toc-{{ headerLevel }}" id="toc-{{ headerID }}"><a href="#{{ headerID }}">{{ h1counter }}.{{ h2counter }}.{{ h3counter }}.</a> {{ headerContent }}</p>
            {% when 4 %}
                {% assign h4counter = h4counter | plus: 1 %}
                {% assign h5counter = 0 %}
                {% assign h6counter = 0 %}
                <p class="toc-item toc-{{ headerLevel }}" id="toc-{{ headerID }}"><a href="#{{ headerID }}">{{ h1counter }}.{{ h2counter }}.{{ h3counter }}.{{ h4counter }}.</a> {{ headerContent }}</p>
            {% when 5 %}
                {% assign h5counter = h5counter | plus: 1 %}
                {% assign h6counter = 0 %}
                <p class="toc-item toc-{{ headerLevel }}" id="toc-{{ headerID }}"><a href="#{{ headerID }}">{{ h1counter }}.{{ h2counter }}.{{ h3counter }}.{{ h4counter }}.{{ h5counter }}.</a> {{ headerContent }}</p>
            {% when 6 %}
                {% assign h6counter = h6counter | plus: 1 %}
                <p class="toc-item toc-{{ headerLevel }}" id="toc-{{ headerID }}"><a href="#{{ headerID }}">{{ h1counter }}.{{ h2counter }}.{{ h3counter }}.{{ h4counter }}.{{ h5counter }}.{{ h6counter }}</a> {{ headerContent }}</p>
        {% endcase %}    
    {% endfor %}
    </div>
</div>
{% endraw %}
{% endhighlight %}


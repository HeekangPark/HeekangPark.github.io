---
title: "정규화 (Normalization)"
order: 11
date: "2020-06-01"
isWriting: true
---

# 정규화의 필요성

다음과 같은 데이터가 주어졌다고 해 보자.

| $x_1$ | $x_2$  |       |  $y$  |
| :---: | :----: | :---: | :---: |
| 4000  | 0.0005 |       |   5   |
| 4000  | 0.0009 |       |   9   |
| 8000  | 0.0004 |       |   4   |
| 8000  | 0.0001 |       |   1   |
| 7000  | 0.0006 |       |   6   |
| 6000  | 0.0005 |       |   5   |
| 8000  | 0.0002 |       |   2   |
| 2000  | 0.0004 |       |   4   |
| 3000  | 0.0005 |       |   5   |
| 4000  | 0.0005 |       |   5   |

짐작했겠지만 사실 이 데이터의 $\boldsymbol{x}[x_1, x_2]$와 $y$ 사이에는 $y = 0 \cdot x_1 + 10000 \cdot x_2$의 관계가 있다.($x_1$은 $y$에 아무런 영향을 끼치지 않는다.)

하지만 이 사실을 모르는 상태에서 이 데이터에 대해 다중 선형 회귀 모델을 만드는 상황을 생각해보자. 편의상 상수항(bias)은 없다고 하면 다음과 같이 $\boldsymbol{w} [w_1, w_2]$를 파라미터로 가지는 모델을 세울 수 있다.

<div class="mathjax-wrapper" markdown="block">

$$y = \boldsymbol{w}^\intercal \cdot \boldsymbol{x} = w_1 x_1 + w_2 x_2 $$

</div>

이제 주어진 데이터를 이용하여 파라미터 최적화를 수행해보자. 주어진 데이터는 입력 데이터의 속성($x_1$, $x_2$) 간의 값과 범위 차이가 큰 특징이 있는 데이터이다. 이런 경우에도 해석적 풀이법을 적용하면 별 문제 없이 $\boldsymbol{w} = [0, 10000]$를 추정해 낸다. 해석적 풀이법은 수학적으로 최적의 해를 찾는 방법이기 때문이다. 하지만 수치 계산법을 적용할 경우, 가끔 수렴하지 않고 발산하거나 수렴 속도가 매우 느리게 되는 현상이 발생한다. 왜 이런 현상이 일어나는 것일까?

수치 계산법 중 하나인 경사 하강법은 다음과 같은 순서로 작동한다.

1. 랜덤한 $\boldsymbol{w}$를 잡는다.
2. 오차 함수 $J$의 그라디언트 $\nabla J_\boldsymbol{w}$를 구한다.
3. 그라디언트로 반대 방향으로 $\boldsymbol{w}$를 업데이트한다 : $\boldsymbol{w} = \boldsymbol{w} - \eta \nabla J_\boldsymbol{w}$

이를 다음과 같이 그림으로 나타낼 수 있다.

{% include caption-img.html src="normalization-normal-parameter-updates.png" title="Fig.01 경사 하강법" description="경사 하강법은 랜덤한 위치에서 시작하여 점진적으로 오차 함수의 값이 가장 작은 진한 노란색 영역으로 다가가는 것이다." %}

그래프의 가로축은 $w_1$, 세로축은 $w_2$를 나타낸다. 검은 색 점은 $\boldsymbol{w}$를 나타낸다. 화살표는 $\boldsymbol{w}$가 업데이트되는 과정을 도식화한 것이다. 그림에서는 총 5번의 파라미터 업데이트가 있었다. 오차 함수 $J$에서 같은 값이 나오는 ($w_1$, $w_2$)는 같은 색으로 표현되어 있다. 색이 진할수록 오차 함수의 값이 작다. 그림에서 보다시피 경사 하강법이 진행됨에 따라 랜덤한 위치에서 시작하여 점진적으로 오차 함수의 값이 가장 작은 진한 노란색 영역으로 다가가고 있다.

그렇다면 우리의 데이터처럼 속성 간 범위 차이가 큰 데이터에 대한 경사 하강법은 어떻게 표현될까?

{% include caption-img.html src="normalization-unnormalized.png" title="Fig.02 범위가 다른 속성을 가진 데이터에서의 경사 하강법" description="파라미터 범위가 큰 속성($w_1$)에 " %}
---
title: "Git 기초"
order: 4
date: "2021-01-08"
---

# Git의 버전 관리 방식

파일의 모든 버전을 저장할 수 있다면 참 좋겠지만, 이렇게 되면 용량 문제가 발생한다. 그래서 많은 버전 관리 시스템들은 각 파일들의 변화량(델타, Delta)만을 기억한다. 이렇게 각 파일들의 델타만을 기억하는 버전 관리 시스템을 델타 기반 버전 관리 시스템이라 한다.

{% include caption-img.html src="git-basics-typical-vcs.png" title="Fig.01 델타 기반 버전 관리 시스템" description="델타 기반 버전 관리 시스템은 각 파일들의 변화량만을 기억한다." %}

델타 기반 버전 관리 시스템에서의 버전 관리 대상은 각 파일들이다. Fig.01의 예에서 볼 수 있듯이 파일 A, B, C 각각에 대해 버전이 따로 관리된다. 따라서 델타 기반 버전 관리 시스템에서 한 파일의 버전을 왔다갔다 하는 것은 다른 파일들에 아무런 영향을 끼치지 않는다(File A의 버전을 롤백한다고 File B의 현재 내용이 바뀌거나 하지 않는다).

하지만 Git은 델타 기반 버전 관리 시스템과 다른 방식으로 작동한다. Git은 파일들의 변화량이 아닌 Git 저장소 내 전체 파일들의 스냅샷(Snapshot)을 저장한다.

{% include caption-img.html src="git-basics-git.png" title="Fig.02 Git" description="Git은 파일들의 변화량이 아닌 파일 시스템의 스냅샷(Snapshot)을 저장한다." %}

Git에서의 버전 관리 대상은 Git 저장소의 전체 파일 시스템이다. Fig.02의 예에서 볼 수 있듯이 Git에서는 새로운 버전이 확정될 때마다[^1] Git 저장소 안에 있는 모든 파일들(File A, B, C)의 현재 상태(스냅샷)를 저장한다(주황색). Git에서의 하나의 버전은 하나의 파일 시스템의 스냅샷을 의미한다. 즉 Git에서 버전을 롤백하면 Git 저장소 안의 전체 파일들이 해당 버전의 파일로 바뀐다는 것이다. 델타 기반 버전 관리 시스템의 경우 특정 버전으로의 이동은 현재 상태에서 델타를 더하거나 빼야 하지만, Git은 스냅샷 그 자체를 저장하므로 델타 연산 없이 곧바로 해당 버전으로 이동할 수 있다.[^2] Git이 다른 버전 관리 시스템과 비교했을 때 속도가 빠른 것이 장점이라 하는데, 델타가 아닌 스냅샷을 저장하는 것이 그 이유 중 하나이다.

[^1]: 이를 커밋(commit)이라 한다.
[^2]: 그러면 한 가지 의문이 생길 수 있다. 이렇게 스냅샷을 저장하게 되면 용량 문제를 어떻게 해결할 수 있을까? 우선 Git은 커밋할 때 특정 파일이 이전 버전과 비교했을 때 변경사항이 없다면 스냅샷에 해당 파일이 아닌 이전 버전의 해당 파일에 대한 링크를 저장한다. Fig.02에서 예를 들면, Version #2에서 Version #3으로 넘어갈 때 File A는 변경사항이 없다(여전히 동일한 File A1이다). 이 경우 Git은 Version #3의 스냅샷에 File A1이 아닌 Version #2의 File A1에 대한 링크를 저장한다. 이렇게 하여 변경사항이 없는 파일에 대한 용량을 줄인다. 또한 Git은 오래된 버전의 경우 스냅샷이 아닌 델타를 저장한다. 언제 스냅샷을 델타로 바꿀지는 Git이 알아서 결정한다(Git의 low-level API를 사용하면 이를 명시적으로 바꿀 수도 있지만, 일반적으로 추천하지 않는다). 즉 Git은 현재 버전 근처의 버전들은 스냅샷으로 저장해 속도를 높이고, 현재 버전과 많이 떨어진 버전들은 델타로 저장해 용량 문제를 해결한다.

# Git에서의 파일 상태

Git은 저장소 안의 파일들을 다음과 같이 구분해서 기억한다.

- Untracked (추적되지 않음) : Git에 아직 등록되지 않은 파일들. Git은 이 파일들의 존재를 (아직) 모른다.
- Tracked (추적됨) : Git에 등록된 파일들. Git은 이 파일들의 버전을 관리한다.
  - Unmodified (변경되지 않음) (= Committed, 커밋됨) : 파일의 내용이 (HEAD[^3]가 가리키고 있는) 스냅샷과 동일한 상태. 즉, 수정되지 않은 파일.
  - Modified (변경됨) : 파일의 내용이 스냅샷과 다른 상태. 즉, 수정된 파일.
    - Staged ()

[^3]: HEAD는 현재 보여지고 있는 스냅샷 버전을 가리키는 상대 참조이다. HEAD의 위치를 바꾸면 버전이 바뀐다.


# 작업공간 (Working Directory)
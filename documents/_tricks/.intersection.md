---
title: "[PyTorch] 두 텐서 간 교집합(Intersection) 구하기"
tag: ["pytorch"]
date: "2020-08-09"
---

다음과 같이 1차원 텐서 `a`, `b`가 주어졌다고 해 보자.

{% highlight python %}
a = torch.LongTensor([1, 2, 3])
b = torch.LongTensor([2, 3, 1, 5])
{% endhighlight %}

두 텐서 간 공통된 원소는(교집합) 다음과 같은 방법으로 추출할 수 있다.

{% highlight python linenos %}
indices = torch.zeros_like(a, dtype=torch.uint8)

for elem in b:
    indices = indices | (a == elem).type(torch.uint8)

intersection = a[indices.type(torch.bool)]
{% endhighlight %}

작동 원리는 다음과 같다.

- line 1 : `a`와 같은 크기의 0으로 초기화된 1차원 텐서 `indices`를 선언하였다.
- line 3~4 : 만약 `a[i]`가 `b`의 원소라면 `indices[i]`는 True(1)로 설정되고, 아니라면 False(0)으로 설정된다.
- line 6 : `indices[i] == True(1)`인 `i` 인덱스의 `a` 원소만 모아 `intersection` 텐서를 만든다. 
---
title: "[Javascript] 자바스크립트 비동기에 관하여"
tags: ["javascript", "nodejs"]
date: "2020-09-28"
---

Node.js가 자바스크립트 프레임워크이고, 단일 쓰레드에서 비동기적(Asynchronous)으로 작동한다는 사실을 모르는 개발자는 거의 없을 것이다. 그런데 이 사실이 너무 유명해지다 보니, 자바스크립트 언어 자체가 비동기적으로 구동된다고 착각하는 개발자들이 많은 것 같다. 이 글에서는 자바스크립트와 비동기 간의 관계를 정리하도록 하겠다.

# 자바스크립트와 비동기

자바스크립트는 기본적으로 (C언어와 같은 다른 언어와 유사하게) 동기적(Synchronous)으로 작동한다. 즉, 코드를 실행하면 위에서부터 아래로 순차적으로 실행된다.

{% highlight javascript %}
console.log("First");
console.log("Second");
{% endhighlight %}

위 코드를 실행하면 "First"가 먼저 출력되고, "Second"가 나중에 출력된다.

그러면 자바스크립트의 `Promise` 클래스나 `async`, `await`과 같은 예약어는 왜 있는 것일까?

자바스크립트는 기본적으로 단일 쓰레드(Single Thread)에서 작동한다. 이 단일 쓰레드에서 연산, DOM 및 UI 조작 등을 다 하는 것이다. 

이런 구조는 다음 코드와 같은 상황에서 사용성을 극도로 낮추게 된다.

{% highlight javascript %}
/* CODE BLOCK A
// 아주 길고 복잡한 연산...
// END OF CODE BLOCK */

/* CODE BLOCK B
// UI 업데이트
// END OF CODE BLOCK */
{% endhighlight %}

아주 길고 복잡한 연산을 수행하는 코드 블럭 A와, UI를 업데이트 하는 코드 블럭 B가 있다. 자바스크립트는 단일쓰레드에서 동기식으로 작동하므로, UI를 업데이트하는 코드 블럭 B는 코드 블럭 A가 다 실행되고 난 이후에야 실행 가능하다. 이렇게 되면 UI가 업데이트되지 않으므로 사용자에게는 시스템이 죽은 것처럼 보이게 된다.

반응성이 중요한 웹 브라우저에게 이는 심각한 문제이다. 그래서 웹 브라우저 개발자들은 `Web API`라는 것을 만들어 자바스크립트를 비동기식으로 사용 가능하게 만들었다. 즉, 웹 브라우저에서 자바스크립트의 비동기 실행을 가능케 하는 것은 자바스크립트 언어가 아닌, 웹 브라우저의 프레임워크인 것이다. Node.js에서도 마찬가지로, `libuv`라 부르는 모듈이 자바스크립트의 비동기적 실행을 가능케 만들었다.

자바스크립트 개발자들은 이런 경우 "선택적으로" 비동기로 코드를 작성할 수 있게 프레임워크를 만들었다.

조금 더 구체적으로 말하면, 웹 브라우저에서 실제로 비동기 코드 실행을 가능하게 하는 것은 자바스크립트 코어 엔진 그 자체가 아니라, Web API라 부르는 부분이다.